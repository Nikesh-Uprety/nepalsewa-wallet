rules:
  - id: hardcoded-api-key
    pattern: |
      const $VAR = "$KEY"
    message: Potential hardcoded API key detected
    languages: [javascript]
    severity: ERROR
    metadata:
      category: security
      technology: 
        - javascript
      cwe: "CWE-798: Use of Hard-coded Credentials"
      confidence: HIGH

  - id: sql-injection
    pattern: |
      "SELECT * FROM $TABLE WHERE $COLUMN = '" + $VAR + "'"
    message: Potential SQL injection vulnerability
    languages: [javascript]
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-89: SQL Injection"
      confidence: HIGH

  - id: xss-innerhtml
    pattern: |
      $EL.innerHTML = $VAR
    message: Potential XSS vulnerability using innerHTML
    languages: [javascript]
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-79: Cross-site Scripting"
      confidence: HIGH

  - id: eval-usage
    pattern: |
      eval($VAR)
    message: Dangerous use of eval()
    languages: [javascript]
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-95: Eval Injection"
      confidence: HIGH

  - id: weak-crypto-math-random
    pattern: |
      Math.random()
    message: Math.random() is not cryptographically secure
    languages: [javascript]
    severity: WARNING
    metadata:
      category: security
      cwe: "CWE-338: Weak PRNG"
      confidence: MEDIUM

  - id: localstorage-sensitive-data
    pattern: |
      localStorage.setItem($KEY, $VALUE)
    message: Avoid storing sensitive data in localStorage
    languages: [javascript]
    severity: WARNING
    metadata:
      category: security
      cwe: "CWE-312: Cleartext Storage of Sensitive Information"
      confidence: MEDIUM
